{"version":3,"file":"VAppBar.mjs","names":["makeVToolbarProps","VToolbar","makeLayoutItemProps","useLayoutItem","makeScrollProps","useScroll","useProxiedModel","useSsrBoot","computed","ref","toRef","watch","genericComponent","useRender","VAppBar","name","props","scrollBehavior","String","modelValue","type","Boolean","default","location","validator","value","includes","height","Number","emits","setup","_ref","slots","vToolbarRef","isActive","behavior","Set","split","hide","has","inverted","collapse","elevate","fadeImage","canScroll","currentScroll","scrollThreshold","isScrollingUp","scrollRatio","isCollapsed","isFlat","flat","opacity","undefined","contentHeight","extensionHeight","setActive","immediate","ssrBootStyles","layoutItemStyles","id","order","parseInt","position","layoutSize","elementSize","active","absolute","toolbarProps","filterProps","_createVNode","_mergeProps","class","style"],"sources":["../../../src/components/VAppBar/VAppBar.tsx"],"sourcesContent":["// Styles\nimport './VAppBar.sass'\n\n// Components\nimport { makeVToolbarProps, VToolbar } from '@/components/VToolbar/VToolbar'\n\n// Composables\nimport { makeLayoutItemProps, useLayoutItem } from '@/composables/layout'\nimport { makeScrollProps, useScroll } from '@/composables/scroll'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useSsrBoot } from '@/composables/ssrBoot'\n\n// Utilities\nimport { computed, ref, toRef, watch } from 'vue'\nimport { genericComponent, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VToolbarSlots } from '@/components/VToolbar/VToolbar'\n\nexport const VAppBar = genericComponent<VToolbarSlots>()({\n  name: 'VAppBar',\n\n  props: {\n    scrollBehavior: String,\n    modelValue: {\n      type: Boolean,\n      default: true,\n    },\n    location: {\n      type: String as PropType<'top' | 'bottom'>,\n      default: 'top',\n      validator: (value: any) => ['top', 'bottom'].includes(value),\n    },\n\n    ...makeVToolbarProps(),\n    ...makeLayoutItemProps(),\n    ...makeScrollProps(),\n\n    height: {\n      type: [Number, String],\n      default: 64,\n    },\n  },\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const vToolbarRef = ref<VToolbar>()\n    const isActive = useProxiedModel(props, 'modelValue')\n    const scrollBehavior = computed(() => {\n      const behavior = new Set(props.scrollBehavior?.split(' ') ?? [])\n      return {\n        hide: behavior.has('hide'),\n        // fullyHide: behavior.has('fully-hide'),\n        inverted: behavior.has('inverted'),\n        collapse: behavior.has('collapse'),\n        elevate: behavior.has('elevate'),\n        fadeImage: behavior.has('fade-image'),\n        // shrink: behavior.has('shrink'),\n      }\n    })\n    const canScroll = computed(() => {\n      const behavior = scrollBehavior.value\n      return (\n        behavior.hide ||\n        // behavior.fullyHide ||\n        behavior.inverted ||\n        behavior.collapse ||\n        behavior.elevate ||\n        behavior.fadeImage ||\n        // behavior.shrink ||\n        !isActive.value\n      )\n    })\n    const {\n      currentScroll,\n      scrollThreshold,\n      isScrollingUp,\n      scrollRatio,\n    } = useScroll(props, { canScroll })\n\n    const isCollapsed = computed(() => props.collapse || (\n      scrollBehavior.value.collapse &&\n      (scrollBehavior.value.inverted ? scrollRatio.value > 0 : scrollRatio.value === 0)\n    ))\n    const isFlat = computed(() => props.flat || (\n      scrollBehavior.value.elevate &&\n      (scrollBehavior.value.inverted ? currentScroll.value > 0 : currentScroll.value === 0)\n    ))\n    const opacity = computed(() => (\n      scrollBehavior.value.fadeImage\n        ? (scrollBehavior.value.inverted ? 1 - scrollRatio.value : scrollRatio.value)\n        : undefined\n    ))\n    const height = computed(() => {\n      if (scrollBehavior.value.hide && scrollBehavior.value.inverted) return 0\n\n      const height = vToolbarRef.value?.contentHeight ?? 0\n      const extensionHeight = vToolbarRef.value?.extensionHeight ?? 0\n\n      return (height + extensionHeight)\n    })\n    function setActive () {\n      if (scrollBehavior.value.hide) {\n        if (scrollBehavior.value.inverted) {\n          isActive.value = currentScroll.value > scrollThreshold.value\n        } else {\n          isActive.value = isScrollingUp.value || (currentScroll.value < scrollThreshold.value)\n        }\n      } else {\n        isActive.value = true\n      }\n    }\n\n    watch(currentScroll, setActive, { immediate: true })\n    watch(scrollBehavior, setActive)\n\n    const { ssrBootStyles } = useSsrBoot()\n    const { layoutItemStyles } = useLayoutItem({\n      id: props.name,\n      order: computed(() => parseInt(props.order, 10)),\n      position: toRef(props, 'location'),\n      layoutSize: height,\n      elementSize: ref(undefined),\n      active: isActive,\n      absolute: toRef(props, 'absolute'),\n    })\n\n    useRender(() => {\n      const [toolbarProps] = VToolbar.filterProps(props)\n\n      return (\n        <VToolbar\n          ref={ vToolbarRef }\n          class={[\n            'v-app-bar',\n            {\n              'v-app-bar--bottom': props.location === 'bottom',\n            },\n            props.class,\n          ]}\n          style={[\n            {\n              ...layoutItemStyles.value,\n              '--v-toolbar-image-opacity': opacity.value,\n              height: undefined,\n              ...ssrBootStyles.value,\n            },\n            props.style,\n          ]}\n          { ...toolbarProps }\n          collapse={ isCollapsed.value }\n          flat={ isFlat.value }\n          v-slots={ slots }\n        />\n      )\n    })\n\n    return {}\n  },\n})\n\nexport type VAppBar = InstanceType<typeof VAppBar>\n"],"mappings":"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"}